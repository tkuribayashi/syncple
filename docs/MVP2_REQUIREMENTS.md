# 📋 Syncple MVP2 要件定義

## 💡 Syncpleのコアコンセプト
**「定型クイックメッセージ＋予定共有でパートナーと繋がる」**

- LINEの代替ではなく、カップル専用のシンプルな連絡・予定共有ツール
- サクッと送れる定型メッセージでストレスフリーなコミュニケーション
- カレンダーでお互いの予定を把握
- ステータスで今の状況を共有

## 🎯 MVP2のゴール
パートナーの状況把握と予定管理の利便性を向上させる

---

## ✨ 新規機能

### 1. **ステータス機能**
**優先度: 🔴 高**

#### 機能概要
パートナーの現在の状態をリアルタイムで共有

#### 詳細要件
- ✅ ステータス種類:
  - 在宅
  - 外出中
  - 仕事中
  - 移動中
  - 取り込み中
  - 自由
- ✅ ホーム画面にステータス表示
- ✅ ワンタップでステータス変更
- ✅ 自動ステータス更新(オプション)
  - 予定に基づく自動変更
- ✅ ステータス変更通知

**データ構造**
```typescript
status: 'home' | 'out' | 'working' | 'moving' | 'busy' | 'free'
statusUpdatedAt: Timestamp
```

### 2. **メッセージ既読機能**
**優先度: 🔴 高**

#### 機能概要
相手がメッセージを確認したか把握できる

#### 詳細要件
- ✅ メッセージ既読表示
- ✅ 既読時刻表示
- ✅ 未読件数バッジ

**データ構造**
```typescript
readBy: {
  [userId: string]: Timestamp
}
```

### 3. **繰り返し予定**
**優先度: 🟡 中**

#### 機能概要
定期的な予定を簡単に登録

#### 詳細要件
- ✅ 繰り返しパターン:
  - 毎日
  - 毎週(曜日指定)
  - 毎月(日付指定)
- ✅ 繰り返し終了日設定
- ✅ 個別の予定編集・削除
- ✅ シリーズ全体の編集・削除

### 4. **通知カスタマイズ**
**優先度: 🟢 低**

#### 詳細要件
- ✅ 通知の種類別ON/OFF
  - メッセージ通知
  - 予定リマインダー
  - ステータス変更通知
- ✅ サイレント時間帯設定

---

## 🔧 既存機能の改善

### 5. **カレンダー機能強化**
**優先度: 🟡 中**

#### 5.1 月表示追加
- ✅ 月間カレンダービュー
- ✅ 週間/月間の切り替え
- ✅ 予定密度の可視化(ドット表示)

#### 5.2 予定リマインダー
- ✅ 予定開始前の通知
- ✅ リマインダー時間設定(5分前/15分前/1時間前/1日前)

#### 5.3 予定フィルタリング
- ✅ 自分の予定のみ表示
- ✅ パートナーの予定のみ表示
- ✅ 全て表示

### 6. **UI/UX改善**
**優先度: 🟡 中**

#### 6.1 ダークモード
- ✅ ダークモード対応
- ✅ システム設定に連動
- ✅ 手動切り替え

#### 6.2 アニメーション
- ✅ スムーズなページ遷移
- ✅ ボタンフィードバック

---

## 🛡️ セキュリティ・管理機能

### 7. **Firebase Security Rules**
**優先度: 🔴 高**

#### 詳細要件
- ✅ Firestore Security Rules実装
- ✅ ユーザー認証チェック
- ✅ ペアIDベースのアクセス制御
- ✅ セキュリティテスト

### 8. **アカウント管理**
**優先度: 🟢 低**

#### 詳細要件
- ✅ アカウント削除機能
- ✅ データ完全削除確認
- ✅ ペア解除機能

---

## 📊 優先順位マトリックス

| 優先度 | 機能 | 理由 |
|--------|------|------|
| 🔴 高 | ステータス機能 | パートナーの状況把握に必須、コアコンセプトに直結 |
| 🔴 高 | メッセージ既読 | 相手が見たか確認できる、安心感の向上 |
| 🔴 高 | Security Rules | セキュリティ必須 |
| 🟡 中 | 繰り返し予定 | 定期的な予定の登録が楽になる |
| 🟡 中 | カレンダー強化 | 予定管理の利便性向上 |
| 🟡 中 | UI/UX改善 | ダークモード、アニメーション等 |
| 🟢 低 | 通知カスタマイズ | 使い勝手の向上 |
| 🟢 低 | アカウント管理 | ペア解除、アカウント削除等 |

---

## 🎯 MVP2 推奨スコープ

**Phase 1 (最優先) - コア機能**
1. ✅ ステータス機能
2. ✅ メッセージ既読機能
3. ✅ Firebase Security Rules

**Phase 2 (次優先) - 利便性向上**
4. ✅ 繰り返し予定
5. ✅ カレンダー月表示
6. ✅ 予定リマインダー

**Phase 3 (余裕があれば) - 快適性向上**
7. ✅ ダークモード
8. ✅ 予定フィルタリング
9. ✅ 通知カスタマイズ

---

## 📝 技術的考慮事項

### 新規依存関係
- なし（既存のFirebase機能のみを使用）

### パフォーマンス
- メッセージの効率的な既読状態管理
- カレンダーの月表示での効率的なデータ取得

### 互換性
- MVP1からのデータマイグレーション不要
- 既存機能への影響最小化

### データ構造の追加
```typescript
// メッセージの既読情報
messages: {
  readBy?: {
    [userId: string]: Timestamp
  }
}

// ユーザーのステータス
users: {
  status?: 'home' | 'out' | 'working' | 'moving' | 'busy' | 'free'
  statusUpdatedAt?: Timestamp
}

// 繰り返し予定
schedules: {
  recurrence?: {
    type: 'daily' | 'weekly' | 'monthly'
    interval: number
    endDate?: string
    daysOfWeek?: number[]  // 週間繰り返し用
    dayOfMonth?: number     // 月間繰り返し用
  }
}
```

---

## 📅 想定スケジュール

**Phase 1 (コア機能)**: 1.5週間
- ステータス機能: 3日
- メッセージ既読: 3日
- Security Rules: 2日
- テスト・調整: 2-3日

**Phase 2 (利便性向上)**: 2週間
- 繰り返し予定: 5日
- カレンダー月表示: 4日
- 予定リマインダー: 3日
- テスト・調整: 2日

**Phase 3 (快適性向上)**: 1週間
- ダークモード: 3日
- 予定フィルタリング: 1日
- 通知カスタマイズ: 2日
- テスト: 1日

**合計**: 4.5週間（約1ヶ月）

---

## 🚀 リリース判定基準

### 必須条件（Phase 1完了時）
- ✅ ステータス機能が動作
- ✅ メッセージ既読機能が動作
- ✅ Security Rulesのテスト完了
- ✅ 既存機能の動作確認
- ✅ モバイル/PCでの動作確認

### 推奨条件（Phase 2完了時）
- ✅ 繰り返し予定が動作
- ✅ カレンダー月表示が動作
- ✅ 予定リマインダーが動作
- ✅ パフォーマンステスト実施

### オプション条件（Phase 3完了時）
- ✅ ダークモードが動作
- ✅ 予定フィルタリングが動作
- ✅ 通知カスタマイズが動作

---

## ⚠️ スコープ外の機能（将来検討）

以下の機能はコアコンセプト「定型クイックメッセージ＋予定共有」から外れるため、現時点では実装しない：

- ❌ メッセージリアクション（絵文字等）
- ❌ 画像・写真共有
- ❌ メッセージ削除機能
- ❌ メッセージ検索
- ❌ データエクスポート

これらの機能が本当に必要かどうかは、ユーザーフィードバックを受けて判断する。

---

## 📌 まとめ

MVP2は「パートナーの状況把握」と「予定管理の利便性向上」に焦点を当てる。

- **コアコンセプトを忘れない**: LINEの代替ではなく、カップル専用のシンプルな連絡・予定共有ツール
- **機能を絞る**: 本当に必要な機能だけを実装する
- **段階的にリリース**: Phase 1だけでもリリース価値がある
